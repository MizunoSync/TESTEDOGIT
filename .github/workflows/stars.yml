name: CI/CD Pipeline

on:
  push:
    branches:
      - main  # Define the branch to trigger the pipeline on push.
  pull_request:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest  # Define the OS.

    steps:
      - name: Checkout do Código
        uses: actions/checkout@v2  # Action to clone the repository.

      - name: Configurar Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '14'  # Adjust to the required Node.js version.

      - name: Instalar Dependências
        run: npm install  # Installs project dependencies.

      - name: Rodar Testes
        run: npm test  # Executes tests (assuming Jest, Mocha, etc.).

      - name: Build do Projeto
        run: npm run build  # Compiles the project.

  deploy:
    needs: build  # Only runs deploy if the "build" job succeeds.
    runs-on: ubuntu-latest

    steps:
      - name: Checkout do Código
        uses: actions/checkout@v2

      - name: Deploy para Servidor
        env:
          FTP_SERVER: ${{ secrets.FTP_SERVER }}
          FTP_USERNAME: ${{ secrets.FTP_USERNAME }}
          FTP_PASSWORD: ${{ secrets.FTP_PASSWORD }}
        run: |
          echo "Fazendo upload dos arquivos..."
          # Deployment commands, e.g., scp or rsync to remote server, or specific commands.
